<section class="w-100 h-100 bg-white overflow-y-auto p-3">
  @if (isLoading) {
    <div class="h-100 w-100 d-flex align-items-center justify-content-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  }

  @if (!isLoading) {
    <section class="col-xl-11">
      <div
        class="w-100 bg-input row mx-auto rounded-top-4 fw-bold fs-l-medium mb-2 mt-2">
        <div class="p-2 col-6 border-end text-center">
          <span>Charges</span>
        </div>
        <div class="p-2 col-6 text-center">
          <span>Produits</span>
        </div>
      </div>

      <div class="w-100 bg-white row mx-auto fs-small mb-2">
        <!-- ####################### ACTIFS SECTION ####################### -->
        <div class="col-6 border-end d-flex flex-column p-2">
          <!-- Parents -->
          @for (left of opResult.left_hand; track $index) {
            <div class="d-flex flex-column gap-2 p-2">
              <div class="d-flex flex-row w-100 align-items-center">
                <a href="javascript:void(0)">
                  <span>
                    <i class="fa-solid fa-plus"></i>
                  </span>
                </a>
                <div
                  class="d-flex flex-row justify-content-between ms-2 flex-grow-1">
                  <span class="fw-bold"
                    >{{ $index + 1 }}. {{ left.description }}</span
                  >
                  <span class="fw-bold"
                    ><app-amount-visibility
                      [amount]="left.total"
                      [currency]="'BIF'"
                      [alwaysShowAmount]="true">
                    </app-amount-visibility
                  ></span>
                </div>
              </div>
            </div>
          }
        </div>

        <!-- ####################### PASSIFS SECTION ####################### -->
        <div class="col-6 d-flex flex-column p-2">
          @for (right of opResult.right_hand; track $index) {
            <div class="d-flex flex-column gap-2 p-2">
              <div class="d-flex flex-row w-100 align-items-center">
                <a href="javascript:void(0)">
                  <span>
                    <i class="fa-solid fa-plus"></i>
                  </span>
                </a>
                <div
                  class="d-flex flex-row justify-content-between ms-2 flex-grow-1">
                  <span [ngClass]="isParentCollapsed[1] ? '' : 'fw-bold'"
                    >{{ $index + 1 }}. {{ right.description }}</span
                  >
                  <span class="fw-bold"
                    ><app-amount-visibility
                      [amount]="right.total"
                      [currency]="'BIF'"
                      [alwaysShowAmount]="true">
                    </app-amount-visibility
                  ></span>
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <div class="w-100 bg-input row mx-auto fs-l-medium mb-2">
        <div class="col-6 border-end p-2">
          <div class="px-4 d-flex flex-row justify-content-between fw-bold">
            <span>Total</span>
            <span
              ><app-amount-visibility
                [amount]="totalLeft"
                [currency]="'BIF'"
                [alwaysShowAmount]="true">
              </app-amount-visibility
            ></span>
          </div>
        </div>

        <div class="col-6 p-2">
          <div class="px-4 d-flex flex-row justify-content-between fw-bold">
            <span>Total</span>
            <span
              ><app-amount-visibility
                [amount]="totalRight"
                [currency]="'BIF'"
                [alwaysShowAmount]="true">
              </app-amount-visibility
            ></span>
          </div>
        </div>
      </div>

      <div
        class="w-100 mx-auto d-flex justify-content-center p-2 fs-l-medium fw-bold bg-secondary rounded-bottom-4">
        <div class="d-flex flex-row gap-4 py-1">
          <span>Difference:</span>
          <span class="text-primary"
            ><app-amount-visibility
              [amount]="opResult.result"
              [currency]="'BIF'"
              [alwaysShowAmount]="true">
            </app-amount-visibility
          ></span>
        </div>
      </div>
    </section>
  }
</section>
